<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate a list of enriched heatmaps from a list of matrices. — hmList • seqEasyFunctions</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate a list of enriched heatmaps from a list of matrices. — hmList"><meta name="description" content="This function takes a list of matrices (typically the output of matList)
and generates a list of enriched heatmaps using the EnrichedHeatmap package.
It allows for customization of color schemes, row splitting, column features,
quantile-based scaling, row name display, window labels, y-axis limits,
summarisation of enrichment, axis labels, row clustering, and log2 transformation."><meta property="og:description" content="This function takes a list of matrices (typically the output of matList)
and generates a list of enriched heatmaps using the EnrichedHeatmap package.
It allows for customization of color schemes, row splitting, column features,
quantile-based scaling, row name display, window labels, y-axis limits,
summarisation of enrichment, axis labels, row clustering, and log2 transformation."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">seqEasyFunctions</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/zackswales/seqEasyFunctions">GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate a list of enriched heatmaps from a list of matrices.</h1>

      <div class="d-none name"><code>hmList.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes a list of matrices (typically the output of <code><a href="matList.html">matList</a></code>)
and generates a list of enriched heatmaps using the <code>EnrichedHeatmap</code> package.
It allows for customization of color schemes, row splitting, column features,
quantile-based scaling, row name display, window labels, y-axis limits,
summarisation of enrichment, axis labels, row clustering, and log2 transformation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hmList</span><span class="op">(</span></span>
<span>  <span class="va">matl</span>,</span>
<span>  <span class="va">wins</span>,</span>
<span>  split <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">split_cols</span>,</span>
<span>  max_quantile <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  min_quantile <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  col_fun <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  show_row_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  win_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  summarise_by <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  axis_labels <span class="op">=</span> <span class="st">""</span>,</span>
<span>  row_km <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  log2 <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-matl">matl<a class="anchor" aria-label="anchor" href="#arg-matl"></a></dt>
<dd><p>A named list of matrices, where each matrix represents signal intensity
over genomic regions (e.g., output of <code><a href="matList.html">matList</a></code>).</p></dd>


<dt id="arg-wins">wins<a class="anchor" aria-label="anchor" href="#arg-wins"></a></dt>
<dd><p>A named integer vector specifying the number of bins (windows) that the
matrices in <code>matl</code> were normalized to for each feature type. The names
should correspond to the feature types (e.g., <code>c("Gene" = 10)</code>).</p></dd>


<dt id="arg-split">split<a class="anchor" aria-label="anchor" href="#arg-split"></a></dt>
<dd><p>An optional <code>data.frame</code> used to split the rows of the heatmaps.
Each column in the data frame will define a way to split the rows.</p></dd>


<dt id="arg-split-cols">split_cols<a class="anchor" aria-label="anchor" href="#arg-split-cols"></a></dt>
<dd><p>A named list specifying the colors for the levels of the splitting variable
provided in <code>split</code>. The names of the list should correspond to the column
names in the data frame used for splitting.</p></dd>


<dt id="arg-max-quantile">max_quantile<a class="anchor" aria-label="anchor" href="#arg-max-quantile"></a></dt>
<dd><p>A numeric value between 0 and 1 specifying the upper quantile for
scaling the color map. Values above this quantile will be capped.</p></dd>


<dt id="arg-min-quantile">min_quantile<a class="anchor" aria-label="anchor" href="#arg-min-quantile"></a></dt>
<dd><p>A numeric value between 0 and 1 specifying the lower quantile for
scaling the color map. Values below this quantile will be capped.</p></dd>


<dt id="arg-col-fun">col_fun<a class="anchor" aria-label="anchor" href="#arg-col-fun"></a></dt>
<dd><p>A character string specifying the color function to use. Options include
"red" (white to red), "bl2rd" (blue to white to red), or "red0" (white to light red to dark red starting from 0).
Alternatively, a custom color function generated by <code><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">circlize::colorRamp2</a></code> can be provided.</p></dd>


<dt id="arg-show-row-names">show_row_names<a class="anchor" aria-label="anchor" href="#arg-show-row-names"></a></dt>
<dd><p>A logical value indicating whether to display row names on the heatmaps.</p></dd>


<dt id="arg-win-labels">win_labels<a class="anchor" aria-label="anchor" href="#arg-win-labels"></a></dt>
<dd><p>An optional character vector specifying the labels for the feature windows
displayed in the top annotation. If <code>NULL</code>, the names of <code>wins</code> are used.</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>An optional numeric vector of length 2 specifying the y-axis limits for the
enrichment profile in the top annotation. If <code>NULL</code>, limits are automatically determined.</p></dd>


<dt id="arg-summarise-by">summarise_by<a class="anchor" aria-label="anchor" href="#arg-summarise-by"></a></dt>
<dd><p>A character string specifying the function to summarise the rows for the
enrichment profile in the top annotation (e.g., "mean", "median").</p></dd>


<dt id="arg-axis-labels">axis_labels<a class="anchor" aria-label="anchor" href="#arg-axis-labels"></a></dt>
<dd><p>A character string specifying the label for the x-axis of the
enrichment profile in the top annotation.</p></dd>


<dt id="arg-row-km">row_km<a class="anchor" aria-label="anchor" href="#arg-row-km"></a></dt>
<dd><p>An integer specifying the number of clusters to perform k-means clustering on the rows.
If <code>NULL</code> or 1, no clustering is performed.</p></dd>


<dt id="arg-log-">log2<a class="anchor" aria-label="anchor" href="#arg-log-"></a></dt>
<dd><p>A logical value indicating whether to apply a log2 transformation (with a pseudocount of 1)
to the matrices in <code>matl</code> before plotting.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of <code>EnrichedHeatmap</code> objects, one for each matrix in the input <code>matl</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Assuming you have generated a list of matrices using matList()</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create a dummy matrix list for demonstration</span></span></span>
<span class="r-in"><span><span class="va">mat_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  sample1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sample2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wins_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FeatureA"</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a list of enriched heatmaps</span></span></span>
<span class="r-in"><span><span class="va">hm_list</span> <span class="op">&lt;-</span> <span class="fu">hmList</span><span class="op">(</span>matl <span class="op">=</span> <span class="va">mat_list</span>, wins <span class="op">=</span> <span class="va">wins_info</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate heatmaps with row splitting and custom colors</span></span></span>
<span class="r-in"><span><span class="va">split_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group1"</span>, <span class="st">"Group2"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">split_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"group"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group1"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"Group2"</span> <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hm_list_split</span> <span class="op">&lt;-</span> <span class="fu">hmList</span><span class="op">(</span>matl <span class="op">=</span> <span class="va">mat_list</span>, wins <span class="op">=</span> <span class="va">wins_info</span>, split <span class="op">=</span> <span class="va">split_df</span>,</span></span>
<span class="r-in"><span>                        split_cols <span class="op">=</span> <span class="va">split_colors</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zack Swales.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

